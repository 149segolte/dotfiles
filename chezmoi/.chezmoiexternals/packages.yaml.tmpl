{{- with (mustMerge ((includeTemplate "dynamic_data.yaml.tmpl" .) | fromYaml) .) -}}
{{- $ := . -}}

{{- if eq .chezmoi.os "linux" -}}

  {{- if gt (len (get .packages.linux .chezmoi.osRelease.id)) 0 -}}
    {{- $sys := get .packages.linux .chezmoi.osRelease.id -}}

    {{- $externals := $sys.external.common -}}
    {{- if gt (len (get $sys.external .chezmoi.hostname)) 0 -}}
      {{- $externals = merge $externals (get $sys.external .chezmoi.hostname) -}}
    {{- end -}}

    {{- $externals | toYaml -}}
  {{- end -}}

{{- end -}}

{{- end -}}
